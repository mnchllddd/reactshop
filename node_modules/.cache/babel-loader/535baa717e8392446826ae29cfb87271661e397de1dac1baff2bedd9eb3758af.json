{"ast":null,"code":"import{useState,useEffect}from\"react\";import{API_KEY,API_URL}from\"../config\";import{Preloader}from\"./preloader\";import{Goodslist}from\"./goodsList\";import{Cart}from\"./cart\";import{BasketList}from\"./basketList\";import{Alert}from\"./alert\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Shop(){const[goods,setGoods]=useState([]);const[loading,setLoading]=useState(true);const[order,setOrder]=useState([]);const[isBasketShow,setBasketShow]=useState(false);const[alertName,setAlertName]=useState(\"\");const addToBasket=item=>{const itemIndex=order.findIndex(orderItem=>orderItem.mainId===item.mainId);if(itemIndex<0){setOrder([...order,{...item,quantity:1}]);}else{const newOrder=order.map(orderItem=>orderItem.mainId===item.mainId?{...orderItem,quantity:orderItem.quantity+1}:orderItem);setOrder(newOrder);}setAlertName(item.displayName);};const incQuantity=itemId=>{const newOrder=order.map(el=>{if(el.mainId===itemId){const newQuantity=el.quantity+1;return{...el,quantity:newQuantity};}else{return el;}});setOrder(newOrder);};const decQuantity=itemId=>{const newOrder=order.map(el=>{if(el.mainId===itemId){const newQuantity=el.quantity-1;return{...el,quantity:newQuantity>=0?newQuantity:0};}else{return el;}});setOrder(newOrder);};const removeFromBasket=itemId=>{const newOrder=order.filter(el=>el.mainId!==itemId);setOrder(newOrder);};const handleBasketShow=()=>{setBasketShow(!isBasketShow);};const closeAlert=()=>{setAlertName(\"\");};useEffect(function getGoods(){fetch(API_URL,{headers:{Authorization:API_KEY}}).then(response=>response.json()).then(data=>{data.shop&&setGoods(data.shop);setLoading(false);});},[]);return/*#__PURE__*/_jsxs(\"main\",{className:\"container content\",children:[/*#__PURE__*/_jsx(Cart,{quantity:order.length,handleBasketShow:handleBasketShow}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"preloader-wrapper\",children:/*#__PURE__*/_jsx(Preloader,{})}):/*#__PURE__*/_jsx(Goodslist,{goods:goods,addToBasket:addToBasket}),isBasketShow&&/*#__PURE__*/_jsx(BasketList,{order:order,handleBasketShow:handleBasketShow,removeFromBasket:removeFromBasket,incQuantity:incQuantity,decQuantity:decQuantity}),alertName&&/*#__PURE__*/_jsx(Alert,{displayName:alertName,closeAlert:closeAlert})]});}export{Shop};","map":{"version":3,"names":["useState","useEffect","API_KEY","API_URL","Preloader","Goodslist","Cart","BasketList","Alert","jsx","_jsx","jsxs","_jsxs","Shop","goods","setGoods","loading","setLoading","order","setOrder","isBasketShow","setBasketShow","alertName","setAlertName","addToBasket","item","itemIndex","findIndex","orderItem","mainId","quantity","newOrder","map","displayName","incQuantity","itemId","el","newQuantity","decQuantity","removeFromBasket","filter","handleBasketShow","closeAlert","getGoods","fetch","headers","Authorization","then","response","json","data","shop","className","children","length"],"sources":["C:/Users/sonyazharkikh/Desktop/2pra/demo/src/components/shop.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { API_KEY, API_URL } from \"../config\";\nimport { Preloader } from \"./preloader\";\nimport { Goodslist } from \"./goodsList\";\nimport { Cart } from \"./cart\";\nimport { BasketList } from \"./basketList\";\nimport { Alert } from \"./alert\";\n\nfunction Shop() {\n    const [goods, setGoods] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [order, setOrder] = useState([]);\n    const [isBasketShow, setBasketShow] = useState(false);\n    const [alertName, setAlertName] = useState(\"\");\n    const addToBasket = (item) => {\n        const itemIndex = order.findIndex(orderItem => orderItem.mainId === item.mainId);\n        \n        if (itemIndex < 0) {\n            setOrder([...order, { ...item, quantity: 1 }]);\n        } else {\n            const newOrder = order.map((orderItem) => \n                orderItem.mainId === item.mainId \n                    ? { ...orderItem, quantity: orderItem.quantity + 1 } \n                    : orderItem\n            );\n            setOrder(newOrder);\n        }\n        setAlertName(item.displayName);\n    };\n    const incQuantity = (itemId) => {\n        const newOrder = order.map((el) => {\n            if (el.mainId === itemId) {\n                const newQuantity = el.quantity + 1;\n                return {\n                    ...el,\n                    quantity: newQuantity,\n                };\n            } else {\n                return el;\n            }\n        });\n        setOrder(newOrder);\n    };\n    const decQuantity = (itemId) => {\n        const newOrder = order.map((el) => {\n            if (el.mainId === itemId) {\n                const newQuantity = el.quantity - 1;\n                return {\n                    ...el,\n                    quantity: newQuantity >= 0 ? newQuantity : 0,\n                };\n            } else {\n                return el;\n            }\n        });\n        setOrder(newOrder);\n    };\n    const removeFromBasket = (itemId) => {\n        const newOrder = order.filter((el) => el.mainId !== itemId);\n        setOrder(newOrder);\n    };\n    const handleBasketShow = () => {\n        setBasketShow(!isBasketShow);\n    };\n    const closeAlert = () => {\n        setAlertName(\"\");\n    };\n    useEffect(function getGoods(){\n        fetch(API_URL, {\n            headers: {\n                Authorization: API_KEY,\n            },\n        })\n            .then((response) => response.json())\n            .then((data) => {\n                data.shop && setGoods(data.shop);\n                setLoading(false);\n            });\n    }, []);\n    \n    return (\n        <main className=\"container content\">\n            <Cart quantity={order.length} handleBasketShow={handleBasketShow}/>\n            {loading ? (<div className=\"preloader-wrapper\"><Preloader /></div>) : (<Goodslist goods={goods} addToBasket={addToBasket}/>)}\n            {isBasketShow && <BasketList order={order} handleBasketShow={handleBasketShow} removeFromBasket={removeFromBasket} incQuantity={incQuantity} decQuantity={decQuantity}/>}\n            {alertName && <Alert displayName={alertName} closeAlert={closeAlert}/>}\n        </main>\n    );\n}\nexport { Shop };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}